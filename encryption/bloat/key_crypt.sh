#!/bin/env bash
##########################################################################################################################################################################################
function gen_map {
  if [[ -f ./keymap ]];then rm ./keymap;fi
  for ((i=0;i<=255;i++));do map_+=(${i});done
  map=( $(echo ${map_[@]} | tr " " "\n" | shuf | tr -d "") )
}
##########################################################################################################################################################################################
function split_map {
  for ((i=0;i<=255;i++));do map_to+=(${map[${i}]});done
  for ((i=0;i<=255;i++));do map_from[${map_to[${i}]}]=${i};done
}
function write_keymap {
  for ((i=0;i<=255;i++));do echo "${map_to[${i}]}" >> ./keymap;done
}
function read_keymap {
  for i in `cat ./keymap`;do
    read_map+=(${i})
  done
  for ((i=0;i<=255;i++));do read_map_to+=(${map[${i}]});done
  for ((i=0;i<=255;i++));do read_map_from[${map_to[${i}]}]=${i};done
}
##########################################################################################################################################################################################
gen_map
split_map
echo "###################################################################################################################################################################################"
echo "shuffled array of 0-255"
for ((i=0;i<=255;i++));do echo "${i}:${map[${i}]}";done
echo "###################################################################################################################################################################################"
echo "map_to and map_from"
for ((i=0;i<=255;i++));do
echo "map_to[${i}]:${map_to[${i}]}  map_from[map_to[${map_to[${i}]}]:${map_from[${map_to[${i}]}]} "
done
echo "###################################################################################################################################################################################"
write_keymap
read_keymap
echo "###################################################################################################################################################################################"
echo "shuffled array of 0-255"
for ((i=0;i<=255;i++));do echo "${i}:${read_map[${i}]}";done
echo "###################################################################################################################################################################################"
echo "map_to and map_from"
for ((i=0;i<=255;i++));do
echo "read_map_to[${i}]:${read_map_to[${i}]}  read_map_from[map_to[${read_map_to[${i}]}]:${read_map_from[${read_map_to[${i}]}]} "
done
echo "###################################################################################################################################################################################"




